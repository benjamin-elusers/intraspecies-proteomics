library(tidyverse)
library(rio)
library(openxlsx)
here::here()
ms.resfile = here::here('..','proteomics-results-INCPM-EL_14975_061221.xlsx')
MS = import(ms.resfile)
MS
MS = import(ms.resfile) %>% janitor::clean_names()
MS
MS = import(ms.resfile) %>% janitor::clean_names(,abbreviations = c("IDS", "BTT",'CQC','LL','SS','SL'))
colnames(MS)
MS = import(ms.resfile) %>% janitor::clean_names(case = "upper_camel",,abbreviations = c("IDS", "BTT",'CQC','LL','SS','SL'))
MS = import(ms.resfile) %>% janitor::clean_names(case = "upper_camel",abbreviations = c("IDS", "BTT",'CQC','LL','SS','SL'))
colnames(MS)
MS = import(ms.resfile) %>% janitor::clean_names(case = "lower_camel",abbreviations = c("IDS", "BTT",'CQC','LL','SS','SL'))
colnames(MS)
MS = import(ms.resfile)
colnames(MS)
ms.resfile = here::here('..','proteomics-results-INCPM-EL_14975_061221.xlsx')
MS = import(ms.resfile)
colnames(MS) = c('uniprot','major_uniprot','protein_names','gene_names','fasta_header','pep','upep',
'BTT-LL/BTT-SL','BTT-LL/BTT-SS',
'CQC-LL/CQC-SL','CQC-LL/CQC-SS',
'BTT-LL/CQC-LL','BTT-SL/CQC-SL','BTT-SS/CQC-SS',
'BTT1-LL','BTT2-LL','BTT1-SL','BTT2-SL','BTT1-SS','BTT2-SS',
'CQC1-LL','CQC2-LL','CQC1-SL','CQC2-SL','CQC1-SS','CQC2-SS',
'seqcov_perc','MW_kDa','qv','score')
MS
colnames(MS) = c('uniprot','major_uniprot','protein_names','gene_names','fasta_header','pep','upep',
'BTT_LL/BTT_SL','BTT_LL/BTT_SS',
'CQC_LL/CQC_SL','CQC_LL/CQC_SS',
'BTT_LL/CQC_LL','BTT_SL/CQC_SL','BTT_SS/CQC_SS',
'BTT1_LL','BTT2_LL','BTT1_SL','BTT2_SL','BTT1_SS','BTT2_SS',
'CQC1_LL','CQC2_LL','CQC1_SL','CQC2_SL','CQC1_SS','CQC2_SS',
'seqcov_perc','MW_kDa','qv','score')
MS$`BTT1-LL`
intensities = MS %>% select(starts_with('int_'))
intensities
colnames(MS) = c('uniprot','major_uniprot','protein_names','gene_names','fasta_header','pep','upep',
'BTT.LL/BTT.SL','BTT.LL/BTT.SS',
'CQC.LL/CQC.SL','CQC.LL/CQC.SS',
'BTT.LL/CQC.LL','BTT.SL/CQC.SL','BTT_SS/CQC.SS',
'int_BTT1.LL','int_BTT2.LL','int_BTT1.SL','int_BTT2.SL','int_BTT1.SS','int_BTT2.SS',
'int_CQC1.LL','int_CQC2.LL','int_CQC1.SL','int_CQC2.SL','int_CQC1.SS','int_CQC2.SS',
'seqcov_perc','MW_kDa','qv','score')
intensities = MS %>% select(starts_with('int_'))
intensities
intensities = MS %>% select('uniprot',starts_with('int_'))
intensities = MS %>% select(uniprot,starts_with('int_'))
intensities
intensities = MS %>% select(major_uniprot,starts_with('int_'))
intensities
MS = import(ms.resfile) %>% filter(str_starts(pattern='CON'))
MS = import(ms.resfile) %>% filter(!str_starts(pattern='CON',string=uniprot))
MS = import(ms.resfile) %>% filter(!str_starts(pattern='CON',string=1))
head(MS)
ms.resfile = here::here('..','proteomics-results-INCPM-EL_14975_061221.xlsx')
MS = import(ms.resfile) %>% filter(!str_starts(pattern='CON',string=1))
colnames(MS) = c('uniprot','major_uniprot','protein_names','gene_names','fasta_header','pep','upep',
'BTT.LL/BTT.SL','BTT.LL/BTT.SS',
'CQC.LL/CQC.SL','CQC.LL/CQC.SS',
'BTT.LL/CQC.LL','BTT.SL/CQC.SL','BTT_SS/CQC.SS',
'int_BTT1.LL','int_BTT2.LL','int_BTT1.SL','int_BTT2.SL','int_BTT1.SS','int_BTT2.SS',
'int_CQC1.LL','int_CQC2.LL','int_CQC1.SL','int_CQC2.SL','int_CQC1.SS','int_CQC2.SS',
'seqcov_perc','MW_kDa','qv','score')
intensities = MS %>% select(major_uniprot,starts_with('int_'))
dim(intensities)
intensities$major_uniprot
intensities = MS %>% select(uniprot,starts_with('int_'))
grep("CON",MS$uniprot)
MS[grep("CON",MS$uniprot),]
contaminated = c( grep("CON_",MS$uniprot), grep("CON_",MS$major_uniprot) ) %>% unique
contaminated
contaminated = c( grep("CON_",MS$uniprot), grep("CON_",MS$major_uniprot) ) %>% unique
MS[contaminated]
MS[contaminated,]
MS.clean = MS %>% filter(str_detect(c(uniprot,major_uniprot),"CON",negate = T) )
library(tidyverse)
library(rio)
library(openxlsx)
ms.resfile = here::here('..','proteomics-results-INCPM-EL_14975_061221.xlsx')
MS = import(ms.resfile) %>% filter(!str_starts(pattern='CON',string=1))
colnames(MS) = c('uniprot','major_uniprot','protein_names','gene_names','fasta_header','pep','upep',
'BTT.LL/BTT.SL','BTT.LL/BTT.SS',
'CQC.LL/CQC.SL','CQC.LL/CQC.SS',
'BTT.LL/CQC.LL','BTT.SL/CQC.SL','BTT_SS/CQC.SS',
'int_BTT1.LL','int_BTT2.LL','int_BTT1.SL','int_BTT2.SL','int_BTT1.SS','int_BTT2.SS',
'int_CQC1.LL','int_CQC2.LL','int_CQC1.SL','int_CQC2.SL','int_CQC1.SS','int_CQC2.SS',
'seqcov_perc','MW_kDa','qv','score')
contaminated = c( grep("CON_",MS$uniprot), grep("CON_",MS$major_uniprot) ) %>% unique
MS.clean = MS %>% filter(str_detect(c(uniprot,major_uniprot),"CON",negate = T) )
MS.clean = MS %>% filter(str_detect(uniprot,"CON",negate = T) )
MS.clean
MS.clean = MS %>% filter(str_detect(uniprot,"CON",negate = T) ) %>% as_tibble()
MS.clean
# WORKING DIRECTORY is current document path
WD = dirname( .rs.api.getActiveDocumentContext()$path )
setwd(WD)
# WORKING DIRECTORY is current document path
WD = dirname( .rs.api.getActiveDocumentContext()$path )
WD
# WORKING DIRECTORY is current document path
WD = dirname( .rs.api.getActiveDocumentContext()$path )
setwd(WD)
ms.resfile = here::here('..','proteomics-results-INCPM-EL_14975_061221.xlsx')
MS = import(ms.resfile) %>% filter(!str_starts(pattern='CON',string=1))
MS
colnames(MS) = c('uniprot','major_uniprot','protein_names','gene_names','fasta_header','pep','upep',
'BTT.LL/BTT.SL','BTT.LL/BTT.SS',
'CQC.LL/CQC.SL','CQC.LL/CQC.SS',
'BTT.LL/CQC.LL','BTT.SL/CQC.SL','BTT_SS/CQC.SS',
'int_BTT1.LL','int_BTT2.LL','int_BTT1.SL','int_BTT2.SL','int_BTT1.SS','int_BTT2.SS',
'int_CQC1.LL','int_CQC2.LL','int_CQC1.SL','int_CQC2.SL','int_CQC1.SS','int_CQC2.SS',
'seqcov_perc','MW_kDa','qv','score')
dim(MS)
# Remove contaminants
contaminated = MS %>% str_detect(uniprot,"CON",negate = T)
# Remove contaminants
contaminated = str_detect(MS$uniprot,"CON",negate = T)
contaminated
head(MS$uniprot)
# Remove contaminants
contaminated = str_detect(MS$uniprot,"CON",negate = T)
# Remove contaminants
contaminated = str_detect(MS$uniprot,"CON")
head(MS$uniprot)
# Remove contaminants
MS$is_contaminated = str_detect(MS$uniprot,"CON")
MS$has_min_2pep    = MS$upep > 1
intensities = MS %>% select(uniprot,starts_with('int_'))
intensities
intensities %>% summarise(c_across(median))
md.int = intensities %>% summarise(c_across(everything(),median))
md.int = intensities %>% summarise(c_across(everything()),median)
?c_across
md.int = intensities %>% summarise(across(everything(),median))
md.int
log10.int = intensities %>% summarise(across(everything,log10))
log10.int = intensities %>% rowwise() %>% summarise(across(everything,log10))
log10.int = intensities %>% rowwise() %>% summarise(across(everything(0),log10))
log10.int = intensities %>% rowwise() %>% summarise(across(everything(),log10))
log10.int = intensities %>% rowwise() %>% mutate(across(everything(),log10,.names=log10.{.col}))
log10.int = intensities %>% rowwise() %>% mutate(across(everything(),log10,.names="log10.{.col}"))
log10.int = intensities %>% rowwise() %>% mutate(across(is.numeric(),log10,.names="log10.{.col}"))
log10.int = intensities %>% rowwise() %>% mutate(across(where(is_numeric),log10,.names="log10.{.col}"))
warnings()
log10.int
log10.int = intensities %>% rowwise() %>% summarise(across(where(is_numeric),log10,.names="log10.{.col}"))
log10.int
cor(intensities[,-1],'spearman','pairwise.complete')
intensities[,-1]
cor(intensities[,-1] %>% as.numeric(),'spearman','pairwise.complete')
cor(intensities[,-1] %>% as.numeric,'spearman','pairwise.complete')
intensities[,-1] %>% as.numeric
intensities = MS %>% select(uniprot,starts_with('int_'))  %>% as_tibble
intensities
log10.int = intensities %>% rowwise() %>% summarise(across(where(is_numeric),log10,.names="log10.{.col}"))
log10.int
any( c('a','b','b') %in% letters[1:5] )
any( c('a','b','c') %in% letters[1:5] )
any( !(c('a','b','c') %in% letters[1:5]) )
knitr::opts_chunk$set(echo = TRUE)
source(here::here("src",'01-read-proteomics-data.r'))
here::here("src",'01-read-proteomics-data.r')
here::here("..src",'01-read-proteomics-data.r')
here::here("",'01-read-proteomics-data.r')
